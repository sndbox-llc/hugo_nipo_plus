+++
description = "日報の報告内容によって必要な行数が変わるようなケースで利用できる反復の入力フォームです。単体では動作せず反復の中に各種フォームを追加することでご利用可能です"
menuTitle = "反復(可変長)入力"
tags = []
title = "反復（可変長）入力フォーム"
toc = true
weight = 400
+++


そもそも反復とはどのようなものでしょうか？例えば次のような日報をイメージしてください。

{{<imgproc sample.png "反復入力フォームの具体例。時間ごとに作業内容を分けて書くといったケースでは必要な行数が毎回変わります。この場合は反復を使うとスマートに表現できます" />}}

上の図はWordで作成した簡易的な日報の例です。赤枠で囲われた領域は作業内容に応じて使用する行数が変わることでしょう。
このように日報作成の都度行数が変化するものは**反復入力フォームで実装**できます。
反復入力フォーム自体は行の制御しか行いません。各列は反復入力の中に埋め込んで設計します。

{{<alice pos="right" icon="ok">}}
つまり反復フォーム単体＋各種入力フォームのあわせ技です
{{</alice>}}

## 反復入力の初期設定

前述の通り、反復入力は単体では機能しないため反復入力を追加後に、反復入力の中に入力フォームを追加していきます。

{{<appscreen filename="template" title="反復入力の設定は反復の中に使用する項目（列）を追加して行きます"  >}}

共通の設定項目については[「各種入力フォームの共通設定項目」](/manual/org/groupsetting/template/make/#common_setting)を参照してください。
以下は本入力フォームにのみ存在する設定項目です

|名称|説明|
|---|---|
|入力切替を無効にする|これがOnの場合、日報作成時に入力方式（ラジオ・プルダウン）を変更するボタンが表示されなくなります。画面をスッキリさせたいときはONにしてください|
|[入力必須](/blog/required/)|これがONの場合、選択肢が選ばれていないと日報の提出ができません|
|初期の行数|日報作成時に反復入力を生成する行数です。初期値は1です|

## 反復入力フォームを使った日報の作成

反復入力フォームを含んだ日報テンプレートを使って日報を書くときの画面は次のように見えます。

{{<appscreen filename="input" title="反復の含まれた日報の入力画面イメージ。スマートフォンではカード風のレイアウトになります"  >}}

表示形式が**表・カードの2種類から切替が可能**です。スマートフォンではカード表示が初期状態になります。

画像では見えていませんが、1行追加ボタンをクリックすると新規の行が一番下に挿入されます。
行を削除したいときは各行の右端にあるゴミ箱アイコンをクリックします。

{{<alice pos="right" icon="book">}}
ゴミ箱が見えないときは横にスクロールしてください
{{</alice>}}

## 反復の日報を表示

反復入力では偶数行と奇数行で色が互い違いに表示されます。

{{<appscreen filename="post" title="反復入力の偶数行は水色の背景で表示されます"  >}}

受信画面でも表示形式を**表・カードの2種類から切替が可能**です。

## 反復の日報をCSVに出力する

反復入力の中で使用されている入力フォームがCSV出力に対応していればCSV出力が可能です。
CSVは1行に1件のデータを表すデータ形式です。しかし反復入力は1件の日報の中に複数行のデータが格納されることになるため、CSV出力の形式は反復入力の行数に合わせて提出者名などの**ヘッダー情報が2行目移行空欄で出力**されます。

{{<imgproc csv.png "日報をCSVに出力した例" />}}

{{<alice pos="right" icon="here">}}2行目以降のヘッダー情報はCSV出力設定でコピー・空欄を選べます{{</alice>}}

### 反復の日報をPDFに出力する

反復の列が多すぎるとPDFに出力する際レイアウトが崩れる可能性があるので注意してください。
基本的には日報テンプレートの仕組みと同様に幅の合計が12に収まるように設計するとはみ出しにくくなります。
PDFに出力したイメージは以下のリンクからダウンロードできます。

{{<attachments style="orange" />}}
