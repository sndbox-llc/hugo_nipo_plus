+++
description = "10:00〜15:00のような期間の入力ができる入力フォームです"
menuTitle = "期間入力"
tags = ["集計可能な入力フォーム"]
title = "期間入力フォーム"
toc = true
weight = 160
+++

{{<imgproc input.png "実際の日報入力画面例" />}}

## 期間入力フォームとは

期間入力フォームは開始時刻と終了時刻を入力できる入力フォームです。入力形式は時刻のみ、日付と時刻、日付から選択できます。
時刻のみの場合はスライダー方式の時刻入力とキーボードによる入力が選べます。
所要時間を入力するとその経過時間(差分)が日報入力画面上にヒントとして表示されます。
期間入力で登録されたデータは経過時間を集計することが可能です。

## 期間入力フォームの初期設定

共通の設定項目については[「各種入力フォームの共通設定項目」]((/org/groupsetting/template/make/#common_setting))を参照してください。
以下は本入力フォームにのみ存在する設定項目です

|名称|説明|
|---|---|
|[入力必須](/blog/required/)|これがONの場合、数値が空欄だと日報の提出ができなくなります|
|初期状態でONにする|これがONの場合、日報作成時にこのチェックボックスはONの状態でスタートします|
|集計する|[データ推移](/report/analytics/list/)・[日報集計](/report/analytics/transition/)でこの項目を表示させる場合はONにします。初期値はONです|
|形式|日付（西暦あり）・日付（西暦無し）・時刻のみ・日付と時刻の4種類から選択します|
|スライダ上の最小|形式が「時刻のみ」の場合に限り表示されます。スライダ式で時刻入力する際のスライダの左端を何時にするか設定します。初期値は8:00です|
|スライダ上の最大|形式が「時刻のみ」の場合に限り表示されます。スライダ式で時刻入力する際のスライダの右端を何時にするか設定します。初期値は20:00です|
|刻み|形式が「時刻のみ」の場合に限り表示されます。1目盛りあたり何分進めるか設定します。初期値は30分です|

入力形式の4種類については次のような形式になります。

|入力形式|フォーマット|例|入力切替|
|---|---|---|---|
|日付（西暦有り)|YYYY/MM/DD|2022/12/01|可|
|日付（西暦なし）|MM/DD|12/01|不可|
|時刻のみ|HH:mm|13:21|可|
|日付と時刻|YYYY/MM/DD HH:mm|2022/12/01 13:21|不可|

{{<alice pos="right" icon="ok">}}
エクセルなどの一般的な表計算ソフトでも解釈可能な形式だよ。
{{</alice>}}

## 期間入力フォームの使用例

期間入力フォームのみで交際された日報テンプレートを自作しました。形式が4種類あるため、説明のため4つのフォームを追加しています。

{{<imgproc date-span-template-edit.png "期間入力フォームのみで構成されたテンプレートの例。これをもとに入力画面や日報受信画面でどのように見えるかを確認しましょう" />}}

この例をもとに実際の入力画面や表示画面を確認してみましょう。

### 期間入力フォームの入力画面

期間入力フォームは入力形式によって入力の画面が変わります。左上から順に「時刻のみ」「日付（西暦あり）」「日付」「日付と時刻」の入力の画面になります。

{{<imgproc input.png "実際の日報入力画面例" />}}

これらのうち、「時刻のみ」と「日付（西暦あり）」では入力方法を切り替えるボタンがついています。
特に「時刻のみ」の入力はスライダー風の入力ですが、この状態だと宵越しの入力はできません。深夜12時をまたぐ入力が必要な場合は入力方式を切り替えることで入力が可能です。

{{<imgproc switch.png "スライダで時刻を入力する際の注意点として日をまたいだ入力ができない。日をまたぐ場合はキーボードで入力する" />}}

また、用途が限定的ではありますが、反復入力（可変長）と組み合わせることで時刻の始点が自動セットされる入力補助が発動します。

{{<imgproc autoset.png "可変長で時刻を使用する際に限り初期値セットの動きが変わる" />}}

## 日付と時刻の日報を受け取ったときにどのように見えるのか？

以下のように表示されます。

{{<imgproc post.png "期間フォームを含んだ日報を受信した画面イメージ" />}}

日報作成時に入力された実際のデータ（自〜至）の他に、計算で求めらされた自〜至までの経過時間が表示されます。
また期間入力フォームは集計可能入力フォームのため、過去データ推移の領域にも集計値が表示されます。
集計上の値は、「単位が分」になっているので注意してください。

{{<alice pos="right" icon="ok">}}
例えば510分は、時分に治すと8時間30分になります
{{</alice>}}

## データ活用編

期間入力フォームでは以下の機能に対応しています。

|[集計可否](/report/analytics/)|[CSV出力](/report/analytics/csv/)|[PDF出力](/report/read/pdf/)|[文字検索](/report/read/list/)|
|:---:|:---:|:---:|:---:|
|○|○|○|○|

### 期間入力フォームの日報をCSVに出力する

期間入力フォームの日報はCSVに出力できます。出力時には「自」と「至」の2列に展開して出力されます。

{{<imgproc csv.png "期間入力フォームを含んだ日報をCSVに出力した例" />}}

出力される値は文字列です。例えば日付と時刻であれば

```sh
2022/05/19 21:00
```

のような値がCSV上に出力されます。
エクセルなどの表計算ではこの形式をシリアル値として変換して日数計算などに利用することが可能です。
詳しくは[営業日報の集計](/blog/sales_report/)を参照してください。

### サンプルデータ

このページで使用した実際のサンプルをダウンロードできます

{{<attachments style="orange" />}}
