+++
description = "日報取得APIキーとCurlコマンドで日報データを自由に取得することができます。他システムとの連携などに活用可能。APIキーが外部に流出したときは即座に無効化してください"
tags = []
title = "APIキーの管理"
toc = true
weight = 101010001
contributors = []
aliases = ['/manual/api/key/']
+++


NipoPlusではWebAPIを公開しています。このWebAPIを使うことで日報データを直接取得できます。
NipoPlusを起動しなくでも日報のデータを取得できるので、例えば機関システムや社内DBに定期的にデータを取り込む処理を自動化するといったことができます。

{{<alice pos="right" icon="ok">}}
自動化は多少のプログラミングの知識が必要になりますが覚えると便利ですよ
{{</alice>}}

2022年10月にWeb API Version 0が公開されました。Version 0は当面の間無償で公開されますが、Version1からAPI機能は有料オプションとして提供される予定です。
費用は1企業単位で1ヶ月800円〜1000円、または売り切りでの販売を予定しています。（人数は関係ありません）


## APIキーとは

APIキーはあなたのアカウントを証明するための鍵となる情報です。APIキーを使うことで、NipoPlusを経由すること無く直接日報やテンプレートなどのデータをダウンロードすることができます。
どちらかといえばWeb技術者向けの機能であり、単純にNipoPlusをアプリから利用する場合は一切触れる必要のない機能です。
例えばAPIキーと[CURL](https://curl.se/)を使って日報のデータをダウンロードし、そのデータを今度は社内の基幹システムに送信するといったことが出来るようになります。

{{<alice pos="right" icon="ok">}}
日報データをCSVに出力してそれを機関システムにインポートすることもできるけど、CSV出力も自動化したいと思うのがプログラマの性です
{{</alice>}}

## APIキーの取得

APIキーを取得するには、APIキーを取得するアカウントで次の手順に従って操作します。

1. メニューから「アカウント」をクリックします
1. APIのセクションまでスクロールします
1. ログインパスワードを入力します

{{<appscreen filename="apikeyGet" title="APIキーを取得するには再認証のためログインパスワードの入力が必要です" >}}

上記の手順で正しいパスワードが入力されるとAPIキーが画面に表示されます。APIキーの隣に「コピー」ボタンが表示されますので、そのボタンを使ってAPIキーをコピーし、安全な場所に貼り付けて保管してください。

{{<alice pos="right" icon="shield">}}
APIキーはパスワードくらい重要な情報だから大切に管理してね
{{</alice>}}

## APIキーの無効化

APIキーが万が一外部に流出した場合や、スタッフが退職してAPIキーを無効にする必要がある場合はAPIキーを破壊してください。
APIキーを破壊するには自身でAPIキーを破壊する方法と、管理者がスタッフのアカウントを無効化することでキーを破壊する方法があります。

### 自分のアカウントから自分のAPIキーを無効化する

1. APIキーの取得画面のすぐ下に「APIキーの破壊」というボタンがありますのでこちらをクリックします。
1. 確認メッセージが表示されるのでOKをクリックします
1. APIキーの無効化と同時にログアウトが行われます

{{<appscreen filename="invoke-api-key" title="APIキーの破壊をクリックしてAPIキーを無効化できます。この操作と同時にログアウトが自動で行われます" >}}

以上の手順でAPIキーを無効化できます。新たにAPIキーが必要な場合は再びAPIキーを取得してください。

{{<alice pos="right" icon="shield">}}
APIキーの無効化にはパスワード入力は不要です
{{</alice>}}

### スタッフアカウントを無効化してAPIキーを無効にする

こちらは管理者が社内スタッフのAPIキーを無効化する手順です。組織設定からスタッフアカウントを無効化することで、そのスタッフのAPIキーも含めて無効化されます。

1. 管理者アカウントで操作します
1. 組織設定をクリック
1. スタッフ管理のセクションで無効化するスタッフを見つける
1. 「有効」ボタンをクリックする（即座にボタンが「無効」に変わります）

{{<appscreen filename="disablestaff" title="特定のスタッフアカウントを無効化することでそのスタッフのAPIキーも含めて無効化されます" >}}

再度スタッフを有効にすることもできますが、無効化した時点で過去のAPIキーは破壊されているためアカウントが有効に戻ってもAPIキーは再取得する必要があります。
より詳しいガイドは[スタッフアカウントの管理](/docs/manual/initial-setting/staff/_about/)を御覧ください。

### その他のAPIキーの失効条件

NipoPlusのAPIキーは基本的に長命ですが、以下のケースでは強制的に失効します。

- ユーザアカウントが削除されたとき
- ユーザアカウントで大きな変更が検知された時（パスワードやメールアドレスの変更など）
