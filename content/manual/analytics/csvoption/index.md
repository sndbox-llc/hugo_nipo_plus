+++
description = "日報データをCSVに出力する際に、予め加工や集計がしやすいように出力の形式を変更できます。CSVファイルの用途に応じて使い分けてください"
menuTitle = "CSV出力のオプション設定"
tags = []
title = "日報CSV出力時の各種設定"
toc = true
weight = 20
+++

CSVの出力オプションではCSVの出力形式を設定できます。縦列の入れ替えやファイル出力の有無が設定できます。
データのバックアップ目的、データベースへのインポート、集計など、CSV出力されたファイルの用途に応じて最適な出力形式を選んでください。
出力設定は「CSV出力」ボタンの隣りにある▼ボタンから設定できます。

{{<appscreen filename="csv-setting" title="CSV出力設定は様々な箇所から設定できます。ここでは受信BOXから設定を開いています"  >}}

{{<alice pos="right" icon="ok">}}
設定の内容変更は自動で保存されます
{{</alice>}}

## CSVデータの変形に関する設定

一部の入力フォームでは1フォームに対して複数の行を使用して出力するオプションが用意されています。例えば選択肢を例にしますと、選択肢の入力は必ず選択肢から選ばれたいづれかの値が入ります。
選択された文字をそのままCSVに出力する方法（列展開をOFF）と、すべての選択肢をCSVの列に生成し、選ばれた項目に○を付けて出力する方法(列展開をON)があります。

**列展開をOFF**にしたときのCSV出力イメージです

|日付|OS|
|---|---|
|2022/01/01|Windows|
|2022/01/02|Mac|
|2022/01/03|iOS|

OSという選択肢があったとして、OSの項目で選ばれたデータがそのまま直接CSV上に埋め込まれます。
{{<alice pos="right" icon="ok">}}
選択肢に対して1列しか使用しないため見た目がスッキリするよ
{{</alice>}}

**列展開をON**にしたときのCSV出力イメージです
|日付|【OS】Windows|【OS】Mac|【OS】Android|【OS】iOS
|---|---|---|---|---|
|2022/01/01|○|-|-|-|
|2022/01/02|-|○|-|-|
|2022/01/03|-|-|-|○|

選択肢の数だけ列が増えるため横に長くなります。各行には実際のデータではなく、列と交差したセルに「○」を出力して表現します。
{{<alice pos="right" icon="ok">}}
集計などに向いている形式です
{{</alice>}}

このような列展開のON/OFF設定が可能な入力フォームは以下の種類があります。

|名称|説明|
|---|---|
|[選択肢（単回答）](/manual/initial-setting/group-setting/template/select/)の展開|オン:選択肢の回答毎に1列使用した出力が行われます。該当する列に○が付きます<br>オフ:1列に回答が出力されます|
|[選択肢（複数回答）](/manual/initial-setting/group-setting/template/select2/)の展開|オン:選択肢（複数回答）の回答毎に1列使用します。該当する列に○が付きます<br>オフ:1列に回答がすべてまとめられます|
|[レート](/manual/initial-setting/group-setting/template/rate/)の展開|オン:レートの最大数の数だけ列が追加され、選択されたレート毎に○がつく形でCSV出力されます<br>オフ:1列にデータの値が直接出力されます|
|[チェックボックス](/manual/initial-setting/group-setting/template/checkbox/)の展開|オン:「Yes」と「NO」の2列に展開されて出力され、該当する列に○が付きます<br>オフ:1列にONとOFFのいづれかの文字が出力されます|

### CSV出力オプション【列の展開】は入力フォームごとに指定可能

CSV出力時のオプションで列の展開をON/OFFできますが、ここでの指定は日報全体に対して有効になります。個別に列の展開を指定したい場合はテンプレート編集画面から各入力フォームごとに個別に設定ができます。

{{<appscreen filename="template-setting" title="日報テンプレート編集からCSVの設定を個別で行う"  >}}

日報テンプレート編集画面で設定した値が最も優先されます

## CSVデータの出力形式に関する設定

並び順と方向に関する設定です。エクセル上でも行える操作になりますが、予め整形しておくことで手間を軽減できます。

|名称|説明|
|---|---|
|行列を入れかえる|オフ:1行に1つの日報を表示します([可変長](/manual/initial-setting/group-setting/template/array/)がある場合は複数行)<br>オン:1列に1つの日報を表示するようになります|
|日付の古い順に出力する|オン:日報の日付が古い順に出力されます。<br>オフ:日報の日付が新しい順に出力されます。<br>※1件の日報だけを選んで出力する[単体出力](/manual/read-report/csv/)では設定の意味はありません|

## CSVデータの出力有無に関する設定

文書IDや日付など、日報のヘッダーに当たる情報の表示有無を設定できます。不要な項目はOFFにすることで見た目をシンプルにできます。

|名称|説明|
|---|---|
|写真・ファイル等を出力|[写真入力フォーム](/manual/initial-setting/group-setting/template/picture/)、[署名入力フォーム](/manual/initial-setting/group-setting/template/sign/)、[ファイル入力フォーム](/manual/initial-setting/group-setting/template/file/)のデータを別フォルダに出力します。出力に必要な時間が多少長くなります|
|コメントを出力|日報に書き込まれたコメントを出力します。出力に必要な時間が多少長くなります|
|提出日を出力|日報の提出日時をCSVにファイルに含めます|
|【可変-提出日】<br>同日報の2行目以降も出力|[可変長](/manual/initial-setting/group-setting/template/array/)がある場合は1つの日報が複数行に分けて出力されますが、同じ日報の2行目以降、提出日を空欄にしたい場合はOFFにします<br>（ONの場合は同じデータで埋められます)|
|提出者IDを出力|日報・チェックシートを作成したスタッフのIDをCSVファイルに含めます|
|提出者名を出力|日報・チェックシートを作成したスタッフ名をCSVファイルに含めます|
|[状態](/manual/read-report/state/)を出力|現在の状態を承認・棄却・新規・進行・修正のいずれかで出力します|
|URLを出力|出力元の日報のURLを出力します|
|承認者名を出力|日報・チェックシートを承認するスタッフと承認・棄却の状態をCSVファイルに出力します。承認者が複数人いる場合は人数分列が追加されて出力されます|
|文書IDを出力|日報やチェックシートには固有のIDが自動で割り当てられますがそのIDをCSV上に出力します|

### 写真・ファイル等を出力についての補足

CSVは純粋なテキストファイルのため、バイナリファイルである「画像」等のファイルをCSV上に出力することはできません。
具体的には以下の入力フォームはCSV上に出力不可能です。

- [写真入力フォーム](/manual/initial-setting/group-setting/template/picture/)
- [署名入力フォーム](/manual/initial-setting/group-setting/template/sign/)
- [ファイル入力フォーム](/manual/initial-setting/group-setting/template/file/)

これらのデータはCSV上では「CSV出力不可」と書かれて出力されます。
写真などのバイナリファイルをダウンロードするには、CSV出力設定から「写真・ファイル等を出力」の項目をONにしてください。
この設定により日報に添付されたファイルが、日報ごとのフォルダに分けて出力されます。

このオプションがONの場合、csv.zipという圧縮ファイル形式でダウンロードが行われます。解凍すると中には通常のcsvファイルの他に、reportsというフォルダがあります。
reportsの中にはスタッフ名＋スタッフIDのフォルダがあり、その中に日付＋日報IDのフォルダが展開されます。
最も深いフォルダの中に、日報に添付された画像などのファイルと、その1件の日報だけを出力したCSVファイル（行列の入れ替え済み）が格納されています。
