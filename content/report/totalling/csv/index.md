+++
title = "日報を一括CSV出力"
# description = "チャプター"
tags = ["CSVエクスポート", "集計機能"]
weight = 30
+++

以下の手順で一定期間の日報やチェックシートを1枚のCSVファイルにエクスポートできます。

1. 日報の集計をクリック（表示されない場合はグループ設定を確認してください）
1. 出力したい期間を選びます（初期値は今月）
1. 出力したいテンプレートを選択します
1. CSV出力ボタンをクリックします

{{<imgproc csvexport.png Resize "1200x" "複数のチェックシートや日報データを1枚のCSVファイルに纏めてダウンロードします" />}}

{{<alice pos="right" icon="ok">}}
これはまとめてCSV出力する方法です。1通の日報だけ個別にCSV出力したい場合は[日報詳細表示のCSV出力ページ](/report/read/csv/)を参照してください
{{</alice>}}

これで指定した期間の、指定したテンプレートで書かれた日報（またはチェックシート）をダウンロードできます。  
処理上はファイルのダウンロードとなるため、ブラウザの設定通りの挙動を振る舞います。
ブラウザの設定によっては自動でdownloadフォルダに入る場合もありますし、保存先を自分で指定する場合もあります。
ブラウザの設定によって異なるためご利用の端末設定をご確認ください。

{{<alice pos="right" icon="ok">}}
ダウンロードしたCSVファイルはエクセルやgoogle splead、テキストエディタ等で開けるよ
{{</alice>}}

## CSVの出力形式を変更する

NipoPlusのCSVの出力はいくつかのオプションを選択してCSVの形式を変更することができます。
出力オプションを変更するには「CSV出力」ボタンの右隣にある下向きの三角矢印ボタンを押して設定できます。
設定には以下の項目があります。また設定は自動で保存され、次回以降も同様の設定でCSV出力が行われます。

{{<imgproc csvsetting.png Resize "1200x" "CSV出力前のオプション設定画面" />}}

|名称|説明|
|---|---|
|[選択肢（単回答）](/org/groupsetting/template/select/)の展開|ONにすると選択肢の回答毎に1列使用した出力が行われます。OFFの場合は1列に回答が出力されます|
|[選択肢（複数回答）](/org/groupsetting/template/select/)の展開|ONにすると選択肢（複数回答）の回答毎に1列使用します。OFFの場合は1列に回答がすべてまとめられます|
|[レート](/org/groupsetting/template/rate/)の展開|ONにするとレートの最大数の数だけ列が追加され、選択されたレート毎に○がつく形でCSV出力されます|
|[チェックボックス](/org/groupsetting/template/checkbox/)の展開|ONにすると「Yes」と「NO」の2列に展開されて出力されます|
|行列を入れかえる|通常は1行に1つの日報を表示しますが、これがONだと1列に1つの日報を表示するようになります|
|提出日を出力|ONの場合は日報の提出日時をCSVにファイルに含めます|
|提出者IDを出力|ONの場合日報・チェックシートを作成したスタッフのIDをCSVファイルに含めます|
|提出者名を出力|ONの場合日報・チェックシートを作成したスタッフ名をCSVファイルに含めます|
|[状態](/report/read/state/)を出力|、現在の状態を承認・棄却・新規・進行・修正のいずれかで出力します|
|承認者名を出力|日報・チェックシートを承認するスタッフと承認・棄却の状態をCSVファイルに出力します。承認者が複数人いる場合は人数分列が追加されて出力されます|
|文書IDを出力|日報やチェックシートには固有のIDが自動で割り当てられますがそのIDをCSV上に出力します|

文字だとうまくイメージしにくいと思いますので、実際のデータを用意しました。一番シンプルな「チェックボックスの展開」を例にしています。
{{<imgproc csv_sample.png Resize "1200x" "CSV出力したデータをエクセルで開いた例" />}}

上が列展開OFFで、下が列展開ONです。緑、黄、赤それぞれが同じデータを指し示していますが、出力のされ方が大きく違います。
特に列展開がONの場合はOFFと比べて2倍の列数になっていることがわかります

### CSVの用途に応じて最適なCSVの出力オプションを選ぶ

このようにチェックシートのデータをCSVに出力する際は形式がある程度操作できることがわかりました。
出力するCSVファイルはその目的に応じて適切なオプションを選ぶことが重要です。
例えばデータの保管用として出力する場合、会議資料や集計用として使用する場合によって適切な形式が異なります。
前述したチェックボックスの例を基準に考えてみましょう。例えば保管用としては列の展開をOFFにしたほうが視認性が高く、見やすい形式となっています。
一方で列を展開すると○と-に分かれるため、エクセルのCountif関数などでデータ件数を集計しやすくなるというメリットがあります。
ご利用目的に応じて最も加工しやすい設定を行うことで、データ加工の手間を削減できる可能性があります。ぜひ最適なオプションを探ってみてください。

### 【補足】可変長の日報をCSV出力する場合

NipoPlusでは行数を自由に追加できる[可変長の入力フォーム](/org/groupsetting/template/array/)があります。可変長入力フォームは必要に応じて行数が変わる入力フォームのため、CSV出力時には少し特殊な処理が行われます。
可変長入力フォームが含まれている日報やチェックシートをCSV出力する際は、その出力期間の中で最も長い可変長を基準として行数が増加されます。
より詳しいガイドについては[可変長の入力フォーム](/org/groupsetting/template/array/)のページを参照してください。

### 【補足】CSV出力が不可能な入力フォームについて

CSVはプレーンなテキストファイルのため、いわゆる「バイナリーファイル」は扱えません。具体的には以下の入力フォームで入力されたデータはCSVに出力することができません。

- [写真入力フォーム](/org/groupsetting/template/picture/)
- [署名入力フォーム](/org/groupsetting/template/sign/)
- [ファイル入力フォーム](/org/groupsetting/template/file/)

これらのデータは「CSV出力不可」と書かれて出力されます。

### サンプルデータのダウンロード

このページで使用した実際のサンプルをダウンロードできます

{{<attachments style="orange" />}}
