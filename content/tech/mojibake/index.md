+++
title = "ダウンロードしたZipファイルが文字化けする原因と解決策-主にWindows"
menuTitle = "Zipを解凍すると文字化けする"
# description = ""
tags = ["技術系ブログ"]
weight = 9
draft = false
[sitemap]
  changefreq = 'monthly'
  priority = 1.0
+++

NipoPlusの一括CSVダウンロードを使って日報やチェックシートのデータをZip形式でダウンロードすると、特定の環境では文字化けを起こすことがあります。

{{<imgproc zipopen1.png "ZIPファイルをダブルクリックで開くと文字化けしてしまう" />}}

全て半角英数字のみで作成されたファイル名は文字化けしませんが、それ以外のファイル名は全て文字化けしています。
一応補足しておくと文字化けしてもCSVファイルはエクセルなどで開くことができます。しかしこれではどのファイルがどれを指しているのか全くわからず、不便なので問題を解決しましょう。

## WindowsでZIPを解凍すると文字化けする原因

文字化けの原因は解凍に使用しているソフトがUTF8という文字コードに対応していないことが原因です。長い間メンテナンスがされていない解凍ソフトは、今の時代主流となりつつあるUTF8という
文字コードに対応しておらず、昔ながらのSHIFT-JISしか対応していないソフトがあります。
筆者が確認できたものでは、次のソフトは文字化けします

- [LhaPlus(ラプラス)](https://forest.watch.impress.co.jp/library/software/lhaplus/)
- [+Lhaca](https://forest.watch.impress.co.jp/library/software/pluslhaca/)

いずれのソフトも長い間メンテナンスがされておらず、UTF8という文字コードに対応していません。
Windowsが一強の時代であればSHIFT-JISが利用できれば問題が有りませんでした。しかし今の時代はスマートフォンやタブレット、MacOSなどの勢力拡大が顕著です。Windows以外の多くはUTF8を利用しているため、SHIFT-JISしか使えない解凍ソフトは時代の流れとともに、その役目を終えようとしています。

{{<alice pos="right" icon="pc">}}
昔からWindowsを使ってる人は条件反射的にLhacaやLhaplusを入れてしまうので注意です。当時は何でも解凍できて便利でした。
{{</alice>}}

## WindowsでZipファイルを文字化けせずに解凍する方法(Windows10の場合)

原因が文字コードにあることはわかりましたので、解決は簡単です。つまりUTF8の文字コードに対応した解凍ソフトを使えばよいのです。
Windows10であればWindows10自体がZIPの解凍機能を備えています。この標準の解凍機能はもちろんUTF8にも対応しているため、文字バケは発生しません。

ZIPファイルを開く時、標準のエクスプローラーで開くように関連付けをしてあげましょう。

1. zipファイルを右クリック
1. プログラムから開くをポイントする
1. 別のプログラムを選択をクリック
1. 「常にこのアプリを使って.zipファイルを開く」にチェックを入れる
1. エクスプローラーを選択してOKをクリック

{{<imgproc kanrenzuke1.png "ZIPファイルを開くときに使用するソフトを変更する" />}}
{{<imgproc kanrenzuke2.png "関連付けの設定画面。エクスプローラーではなくUTF8に対応した解凍ソフトを指定しても良いです。" />}}

これで.zipファイルを見つけると、Windows標準のエクスプローラーで開くようになります。この設定でzipファイルのアイコンも変わったはずです。
さて、これでZipファイルを開いてみましょう。

{{<imgproc unzip.png "Windows標準のエクスプローラーで解凍ができました" />}}
