+++
title = "日報やチェックシートをCSV出力"
description = "1件の日報やチェックシートをCSV形式でエクスポートします。出力形式を変更することで様々な用途に利用できる元データとして活用可能"
tags = ["CSVエクスポート", "日報を読む"]
weight = 30
[sitemap]
  changefreq = 'weekly'
  priority = 1.0
+++


{{<alice pos="right" icon="ok">}}
ここでは1件のデータをCSV出力します。複数まとめて出力したいときは[一括CSV出力](/report/totalling/csv/)を参照
{{</alice>}}

表示中の日報やチェックシートをそのままCSVに出力できます。出力する手順は次の通りです。

1. CSV出力したい日報・チェックシートを表示
1. 右メニューから「CSV出力」をクリック

{{<imgproc csv.png Resize "1200x" "画面に表示されている日報・チェックシートを1件づつCSV出力できます。" />}}

CSV出力をクリックするとデータがCSV形式に変換され、ダウンロードが開始されます。ダウンロードの処理はお使いのブラウザや環境設定によって異なります。
普段インターネットで何かをダウンロードしたときと同じ振る舞いをしますのでいつもどおりの手順でダウンロードしてください。


{{<alice pos="right" icon="ok">}}
ダウンロード先を選択する形式の場合もあれば、勝手にdownloadフォルダに保存される設定もあるね
{{</alice>}}

ダウンロードされたCSVファイルはメモ帳などのテキストエディタや、エクセルなどの表計算ソフトを使って開くことができます。
少し専門的な話になりますがCSVファイルの文字コードはUTF-8という形式になります。エクセル2007以前のように古いエクセルではCSVファイルをShift-jis形式で開こうとするため、文字ーコード違いによる文字化けが起きる可能性があります。
もし文字化けしてしまった場合は[Google Splead](https://www.google.com/intl/ja_jp/sheets/about/)など他のソフトを使って開くか、[こちらの記事](https://www.pc-koubou.jp/magazine/38143)を参考に文字化けを解消してください。

{{<imgproc excel.png Resize "1200x" "CSV出力されたデータをエクセルで開いた画面の例。Mac版のエクセルですが問題なく開くことができました。" />}}

エクセルは列番号が表示されるのでこれを基準に各列について紹介します。

|列番号|名称|説明|
|---|---|---|
|A列|提出日|日報の提出日が記載されます。文字の日付ですがエクセルでシリアル値に変換できます|
|B列|提出者ID|日報やチェックシートを作成したスタッフのIDです|
|C列|提出者名|日報やチェックシートを作成したスタッフの名前です|
|D列|状態|新規・承認・棄却・修正・進行のいづれかが入ります|
|E列以降|テンプレート|E列以降はCSV出力したテンプレートの形式に添って１項目につき1列展開されます。設定や項目によっては1項目に付き複数の列が展開される場合もあります|

## CSV出力形式の設定について

CSVに出力する前に出力の形式をある程度設定できます。設定内容はスタッフごとに自動で保存されます。つまりAさんとBさんではそれぞれ異なる設定が記録されます。

{{<alice pos="right" icon="ok">}}
CSVは個別設定だけど一方でPDF出力の設定などは全体が同じ設定を共有するものもあるよ。
{{</alice>}}

CSVの出力設定を行うにはCSV出力ボタンの右端にある下向きの三角ボタンをクリックしてください。

{{<imgproc csvsetting.png Resize "1200x" "CSV出力の設定変更を表示するには下向き三角アイコンをクリックします。設定の内容は自動で保存されます。" />}}

各種設定項目については次のとおりです。

|名称|説明|
|---|---|
|[選択肢（単回答）](/org/groupsetting/template/select/)の展開|ONにすると選択肢の回答毎に1列使用した出力が行われます。OFFの場合は1列に回答が出力されます|
|[選択肢（複数回答）](/org/groupsetting/template/select2/)の展開|ONにすると選択肢（複数回答）の回答毎に1列使用します。OFFの場合は1列に回答がすべてまとめられます|
|[レート](/org/groupsetting/template/rate/)の展開|ONにするとレートの最大数の数だけ列が追加され、選択されたレート毎に○がつく形でCSV出力されます|
|[チェックボックス](/org/groupsetting/template/checkbox/)の展開|ONにすると「Yes」と「NO」の2列に展開されて出力されます|
|行列を入れかえる|通常は1行に1つの日報を表示しますが、これがONだと1列に1つの日報を表示するようになります|
|提出日を出力|ONの場合は日報の提出日時をCSVにファイルに含めます|
|提出者IDを出力|ONの場合日報・チェックシートを作成したスタッフのIDをCSVファイルに含めます|
|提出者名を出力|ONの場合日報・チェックシートを作成したスタッフ名をCSVファイルに含めます|
|[状態](/report/read/state/)を出力|、現在の状態を承認・棄却・新規・進行・修正のいずれかで出力します|
|承認者名を出力|日報・チェックシートを承認するスタッフと承認・棄却の状態をCSVファイルに出力します。承認者が複数人いる場合は人数分列が追加されて出力されます|
|文書IDを出力|日報やチェックシートには固有のIDが自動で割り当てられますがそのIDをCSV上に出力します|

一括CSV出力でも設定方法は同じ手順で操作できます。オプションの設定による出力例についても触れていますので、詳しくは[一括CSV出力のページ](/report/totalling/csv/)を御覧ください。
