+++
url = "/docs/manual/initial-setting/template/array/"
title = "【反復入力】行数を自由に増減できる表です"
menuTitle = "🧩反復入力"
description = "テンプレートカスタムパーツの1つ。報告内容によって行をまるごと増やしたいときに使用します。例えば時間ごとに作業内容を記したいとき、時間が何行になるか都度変わるためこのフォームを使用して解決できます。"
toc = true
weight = 10708
tags = ["テンプレートパーツ", "テンプレート"]
contributors = []
+++

そもそも反復とはどのようなものでしょうか？例えば次のようなレポートをイメージしてください。

{{<iTablet filename="img/array" msg="よく見るやつです。あ、後ろの説明が隠れてるときは✗ボタンで私を消してね▶">}}

「作成者」や「天候」といった項目はそれぞれ固定ですが、その下にある「時刻、分類、生産数」といった表はレポート作成の都度、行数が変わります。（上の図でいうと赤枠で囲まれた部分）
このようなフォームは**反復入力フォームで実装**できます。
反復入力フォーム自体は行の制御しか行いません。各列は反復入力の中に埋め込んで設計します。

## 反復入力の初期設定{#settingArray}

前述の通り、反復入力は単体では機能しないため反復入力を追加後に、反復入力の中に入力フォームを追加していきます。

{{<icatch filename="img/template" msg="反復入力の設定は反復の中に使用する項目（列）を追加して行きます">}}

以下は本入力フォームにのみ存在する設定項目です

<dl class="basic">
  <dt>入力切替を無効にする</dt>
  <dd>これがOnの場合、レポート作成時に入力方式（ラジオ・プルダウン）を変更するボタンが表示されなくなります。画面をスッキリさせたいときはONにしてください</dd>
  <dt><a href="/tips/required/">入力必須</a></dt>
  <dd>これがONの場合、選択肢が選ばれていないとレポートの提出ができません</dd>
  <dt>初期の行数</dt>
  <dd>レポート作成時に反復入力を生成する行数です。初期値は1です</dd>
</dl>

補足:[共通設定事項](/docs/manual/initial-setting/template/make/#common_setting)

反復入力フォームを含んだテンプレートを使って[レポートを書く](/docs/manual/write-report/parts/#array)ときの画面は次のように見えます。

## 反復のレポートを表示{#show}

反復入力では偶数行と奇数行で色が互い違いに表示されます。

{{<icatch filename="img/post" msg="反復入力の偶数行は水色の背景で表示されます。視認性UP" alice="ok">}}

受信画面でも表示形式を**表・カードの2種類から切替が可能**です。

## 反復のレポートをCSVに出力する{#csv}

反復入力の中で使用されている入力フォームがCSV出力に対応していればCSV出力が可能です。
CSVは1行に1件のデータを表すデータ形式です。しかし反復入力は1件のレポートの中に複数行のデータが格納されることになるため、CSV出力の形式は反復入力の行数に合わせて提出者名などの**ヘッダー情報が2行目移行空欄で出力**されます。

{{< excelTable >}}
提出日, 状態, 文書ID, 承認者1, 作成者, 【晴れ】天候, 【雨】天候, 【自】時間, 【至】時間, 【休憩】時間, 【正常】分類, 【稼働停止】分類, 【メンテナンス】分類, 生産数（個）
2023/1/19 11:57, 進行, Ij2Lhek, 管理者A, Nipoアリス, ○, -, 8:00, 11:00, ○, -, ○, , 5
, , , , , , , 12:30, 16:30, -, -, ○, , 0
, , , , , , , 18:00, 20:00, ○, -, -, , 2
{{< /excelTable >}}

## 反復のレポートをPDFに出力する{#pdf}

反復の列が多すぎるとPDFに出力する際レイアウトが崩れる可能性があるので注意してください。
基本的にはテンプレートの仕組みと同様に幅の合計が12に収まるように設計するとはみ出しにくくなります。
