+++
description = "スタッフの名前や使用した機材の回数をエクセルで簡単に集計するためのCOUNTIF関数を紹介。さらに複数条件での集計に役立つCOUNTIFS関数も解説します"
title = "エクセルのCOUNTIF・COUNTIFSを駆使してスタッフの日報提出回数や機材使用回数を効率的に集計"
menuTitle = "エクセルのCOUNTIF・COUNTIFSを駆使してスタッフの日報提出回数や機材使用回数を効率的に集計"
toc = true
tags = ["エクセル",  "集計"]
date = "2023-10-23"
images = ["icatch.png"]
draft = false
[sitemap]
  priority = 0.9
+++

例えば次のようなエクセルシートがあったとします。特にE列に注目してください。

{{< excelTable >}}
提出日, 提出者名, 承認者1, 承認者1詳細, 使用社用車, 業務報告, 次回予定
2023/10/27, アリス, AdminA, 未処理, C号車, これはサンプルです, 特になし
2023/10/22, ボブ, AdminA, 未処理, その他, これはサンプルです, 特になし
2023/10/21, ボブ, AdminA, 未処理, A号車, これはサンプルです, 特になし
2023/10/21, アリス, AdminA, 未処理, B号車, これはサンプルです, 特になし
2023/10/18, アリス, AdminA, 未処理, B号車, これはサンプルです, 特になし
2023/10/12, アリス, AdminA, 未処理, A号車, これはサンプルです, 特になし
2023/10/04, アリス, AdminA, 未処理, B号車, これはサンプルです, 特になし
2023/10/02, アリス, AdminA, 未処理, A号車, これはサンプルです, 特になし
2023/10/01, アリス, AdminA, 未処理, A号車, これはサンプルです, 特になし
{{< /excelTable >}}

E列には「使用社用車」が格納されています。A号車、B号車などの値が入ります。
A号車が何回使用されたのかをCountif関数で簡単に求めることができます。

## 単語の数を数えるにはCOUNTIF関数を使う{#use_countif}

空欄ではないセルを数えるためには「COUNT関数」を使いますが、特定の単語を数える場合には「COUNTIF関数」が適しています。


{{<imgproc countif.png "単語の出現した回数を数えるにはcountif関数を使う" />}}

<dl class="basic">
<dt>範囲</dt>
<dd>単語の出現回数を数える範囲を選択します</dd>
<dt>条件</dt>
<dd>数えたい単語のセルを１つ選択します</dd>
</dl>

予め数えたい単語のリストを用意しておくことがポイントです。上の画像で言うところのE13:E16セルが単語のリストになります。
リストを作っておくことで、COUNTIF関数をフィルコピーしたときに楽に集計ができます。
このとき、**範囲は絶対参照にする**ことを忘れないようにしてください。


## 日報の提出者の数を数えて提出漏れを調査{#count_report}

さて、このCOUNTIF関数を使えば、スタッフ名に基づいて日報の提出回数を簡単にカウントできます。
日報の提出者をカウントし、どのスタッフが何枚の日報を書いたのかをCOUNTIFで求めてみましょう。

{{<imgproc staffcount.png "スタッフの提出回数を数えるのにもCOUNTIF関数が役に立ちます" />}}

「使用社用車」のときと使い方は同じです。スタッフを数えるので数える範囲はBの列になります。
スタッフの名簿も別途用意しておくと良いでしょう。
結果は「アリス」が７件、「ボブ」が２件の日報を提出していることがわかりました。出勤日数に照らせば提出漏れを発見できますね。


{{<alice pos="right" icon="here">}}
同姓同名のスタッフが居るときは注意が必要です
{{</alice>}}

## 【StepUP】COUNTIFSでスタッフごとの使用車両回数を簡単集計{#stepup_countifs}

応用編です。少し難しくなります。
使用車両の総使用回数はCOUNTIF関数で算出できますが、アリスとボブ、それぞれに分けて集計してみましょう。やり方はいくつかありますが、先ほど使ったCOUNTIF関数に複数条件を指定できる**COUNTIFS関数**を使ってみます。  
COUNTIFS関数は範囲と条件を複数個指定できる関数です。使い方はCOUNTIFと似ています。


{{<imgproc countifs.png "より細かい条件を指定するにはCOUNTIFS関数を使用します。" />}}

アリスがA号車を使った回数、ボブがA号車を使った回数のようにスタッフごとに分けてカウントできていることがわかりますね。
ただこの欠点はスタッフのリストと社用車のリストの交差表を作る必要がある点です。

{{<alice pos="right" icon="ok">}}
ピポットテーブルも一つの手段ですが、ここでは関数を中心に解説します
{{</alice>}}

今回使用したエクセルファイルも公開していますのでダウンロードしてご利用ください。  
[COUNTIFを使ったエクセルサンプルをダウンロード](countif.xlsx)


## もっと楽に集計するなら日報アプリを是非ご検討ください{#use_report_management_app}

COUNTIF関数は非常に便利ですが、スタッフリストや社用車のリストの作成、入力ミスがないかのチェックなど、細心の注意が必要です。
入力が**１文字も間違えていないことが大前提**となってきます。
A号車ではなく「A車」のように略して記述されると、正しい集計結果が得られません。

リスト作成の手間も不要で、入力ミスも防ぐことができるNipoPlusでは、今回紹介したような集計を全部自動で行なえます。

{{<icatch filename="countif" msg="SUMIFを自動で" title="日報アプリNipoPlusではCOUNTIFと同様の機能が使えます"  alice="guide">}}


日報の作成はスマートフォンからも簡単に行え、提出された日報を一つのシートに集約してダウンロード可能です。今回使用したデータも、NipoPlusでダウンロードしたものです。

無料での利用も可能なので、ぜひ一度試してみてください。
