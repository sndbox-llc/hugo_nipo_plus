+++
description = ""
menuTitle = "CSV出力のオプション設定"
tags = []
title = "日報CSV出力時の各種設定"
toc = true
weight = 31
+++

NipoPlusのCSVエクスポート機能には様々なオプションが用意されており、これらの設定を変更することで様々な形で日報をCSVに変換できます。
CSVエクスポートのオプションは次のページから設定が可能です

- [日報詳細表示画面](/report/read/csv/)
- [日報集計画面](/report/totalling/transition/)

どちらの画面にも「CSV出力」というボタンがあり、そのボタンの右端にある下向きの三角ボタン（▼のようなかたち）をクリックすることで設定画面を表示します。
{{<imgproc csvsetting.png "この画像は日報詳細表示画面から設定を開いた例です" />}}

どちらの画面から設定しても結果は同じです。なお設定の内容変更は自動で保存されます。

## CSV出力オプション項目について

CSV出力オプションには多くのオプションがありますが、その多くはON/OFFの2択で設定できるものになります。

### データの変形に関する設定

データの表現方法に関する設定です。エクセルなどで集計や並べ替えを行う際、これらの設定によって作業の負担を軽減できる可能性が高くなります。

|名称|説明|
|---|---|
|[選択肢（単回答）](/org/groupsetting/template/select/)の展開|オン:選択肢の回答毎に1列使用した出力が行われます。該当する列に○が付きます<br>オフ:1列に回答が出力されます|
|[選択肢（複数回答）](/org/groupsetting/template/select2/)の展開|オン:選択肢（複数回答）の回答毎に1列使用します。該当する列に○が付きます<br>オフ:1列に回答がすべてまとめられます|
|[レート](/org/groupsetting/template/rate/)の展開|オン:レートの最大数の数だけ列が追加され、選択されたレート毎に○がつく形でCSV出力されます<br>オフ:1列にデータの値が直接出力されます|
|[チェックボックス](/org/groupsetting/template/checkbox/)の展開|オン:「Yes」と「NO」の2列に展開されて出力され、該当する列に○が付きます<br>オフ:1列にONとOFFのいづれかの文字が出力されます|


文字だとうまくイメージしにくいと思いますので、実際のデータを用意しました。一番シンプルな「チェックボックスの展開」を例にしています。
{{<imgproc csv_sample.png "CSV出力したデータをエクセルで開いた例" />}}

上が列展開OFFで、下が列展開ONです。緑、黄、赤それぞれが同じデータを指し示していますが、出力のされ方が大きく違います。

{{<alice pos="right" icon="ok">}}
列展開がONの場合はOFFと比べて2倍の列数になっているね
{{</alice>}}

### データの出力順に関する設定

並び順と方向に関する設定です。エクセル上でも行える操作になりますが、予め整形しておくことで手間を軽減できます。

|名称|説明|
|---|---|
|行列を入れかえる|オフ:1行に1つの日報を表示します([可変長](/org/groupsetting/template/array/)がある場合は複数行)<br>オン:1列に1つの日報を表示するようになります|
|日付の古い順に出力する|オン:日報の日付が古い順に出力されます。<br>オフ:日報の日付が新しい順に出力されます。<br>※1件の日報だけを選んで出力する[単体出力](/report/read/csv/)では設定の意味はありません|

### データの出力有無に関する設定

文書IDや日付など、日報のヘッダーに当たる情報の表示有無を設定できます。不要な項目はOFFにすることで見た目をシンプルにできます。

|名称|説明|
|---|---|
|写真・ファイル等を出力|[写真入力フォーム](/org/groupsetting/template/picture/)、[署名入力フォーム](/org/groupsetting/template/sign/)、[ファイル入力フォーム](/org/groupsetting/template/file/)のデータを別フォルダに出力します。出力に必要な時間が多少長くなります|
|コメントを出力|日報に書き込まれたコメントを出力します。出力に必要な時間が多少長くなります|
|提出日を出力|日報の提出日時をCSVにファイルに含めます|
|【可変-提出日】<br>同日報の2行目以降も出力|[可変長](/org/groupsetting/template/array/)がある場合は1つの日報が複数行に分けて出力されますが、同じ日報の2行目以降、提出日を空欄にしたい場合はOFFにします<br>（ONの場合は同じデータで埋められます)|
|提出者IDを出力|日報・チェックシートを作成したスタッフのIDをCSVファイルに含めます|
|提出者名を出力|日報・チェックシートを作成したスタッフ名をCSVファイルに含めます|
|[状態](/report/read/state/)を出力|現在の状態を承認・棄却・新規・進行・修正のいずれかで出力します|
|URLを出力|出力元の日報のURLを出力します|
|承認者名を出力|日報・チェックシートを承認するスタッフと承認・棄却の状態をCSVファイルに出力します。承認者が複数人いる場合は人数分列が追加されて出力されます|
|文書IDを出力|日報やチェックシートには固有のIDが自動で割り当てられますがそのIDをCSV上に出力します|

### CSV出力が不可能な入力フォームについて

NipoPlusではテンプレートを自作できるのが大きな特徴です。使用している入力フォームの中にはCSV出力に対応していないものもありますので、CSV出力を前提とした運用をお考えの場合はこれらの入力フォームを使用しないほうがより確実です。 CSVに出力できない入力フォームは以下のとおりです

- [写真入力フォーム](/org/groupsetting/template/picture/)
- [署名入力フォーム](/org/groupsetting/template/sign/)
- [ファイル入力フォーム](/org/groupsetting/template/file/)

これらのデータは「CSV出力不可」と書かれて出力されます。
