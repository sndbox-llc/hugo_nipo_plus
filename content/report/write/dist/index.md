+++
title = "日報の提出先と共有先"
draft = false
tags = ["日報を書く"]
weight = 20
+++

日報は通常、上司に対して提出されるものです。NipoPlusでは提出先と他に日報を読める人（以下、共有先）の2種類で日報に対するアクセス権限を設定しています。
先にこれらの用語について明確に定義をしておきましょう

|用語|解説|通知|複数指定|
|---|---|:---:|:---:|
|提出先|その日報を承認・棄却できるスタッフです。|有り|可|
|共有先|その日報を閲覧できるスタッフです。|無し|可|

メールのシステムに置き換えて例えるとイメージしやすいです。

- 提出先は「宛先」に該当し、最も読んでほしいスタッフを指定します。
- 共有先は「CC」に該当し、合わせて読んでもらいたいスタッフを指定します。

共有先も提出先も、日報に対してコメントを書いたり、CSVに出力したり集計することができます。唯一の違いは「承認・棄却」権限の有無です。

## 提出先を1名と共有先を数名指定した場合

まず最もシンプルなケースを確認してみましょう。あるチェックシートを作成して提出先にA部長、共有先には3名のスタッフを指定したと仮定します。

{{<imgproc onedist.png   "前提条件：提出先を1名、共有先を3名にしてチェックシートを提出したとします" />}}

提出先にも共有先にもA部長の名前を指定していますが、この場合A部長は「提出先」として扱われます。

{{<alice pos="right" icon="default">}}
共有先にA部長をわざわざ入れる必要は有りませんが説明のためわざとセットしています
{{</alice>}}

さてこの日報をA部長とそれ以外のスタッフから見た違いを確認してみましょう。

### 提出先アカウントからみた日報

A部長のアカウントでログインして見ました。A部長は提出先として指定されているため、その日報を承認、棄却できる権限があります。また、A部長しか承認する人が居ないためA部長は最終承認権者でもあります。

{{<imgproc sc1.png   "提出先に指定されたスタッフの画面からみた日報画面。承認や棄却ボタンが配置されていることが確認できます" />}}

承認ボタンを押すと検印欄に自分の名前のはんこが押印され、日報の状態が「承認」に切り替わります。棄却を押すと日報の状態が「棄却」に切り替わります。

{{<alice pos="right" icon="default">}}
日報の状態は、新規・進行・棄却・承認・修正の5種類あります。詳しくは[日報の承認](/report/read/state/)を御覧ください
{{</alice>}}

### 共有先アカウントからみた日報

先程の日報を承認権限のないアカウントから見てみましょう。アカウントを替えて、今度は共有先のアカウント（木村常務）から同じ日報を表示してみました。

{{<imgproc sc2.png   "共有先に指定されたスタッフの画面絡みた日報。承認ボタンが表示されず、代わりに既読ボタンが表示されています" />}}

承認・棄却ボタンが表示されていません。代わりに「既読」ボタンが表示されます。既読を押すと既読者リストに名前が追加されます。
共有先といってもPDF出力やコメント、CSV出力など多くの機能は利用可能です。

{{<alice pos="right" icon="default">}}
このように、提出先と共有先では同じ日報を表示してもボタンの配置が若干変化します
{{</alice>}}

## 日報の提出先が複数人いる場合の承認リレー

提出先が1名の場合はその人が最終承認権限者なので話はシンプルです。NipoPlus一方で提出先を複数指定することもできますが、この場合は提出先と共有先が状況に応じて自動で変化していきます。
例えば次のようなチェックシートを作成してたと仮定します。

{{<imgproc relay1.png   "提出先を3名に増やしました。共有先は今回あまり関係ないためあえて未指定にします" />}}

このとき提出先に指定する順番も重要です。左側から先に承認が行われていきます。全体の流れを図にすると次のようなイメージです。

<div style="overflow:scroll">
{{<mermaid align="center">}}
graph LR;
  スタッフ -->|日報提出| A部長
  A部長 -->|承認| 橋本主任
  橋本主任 -->|承認| 木村常務
{{< /mermaid >}}
</div>

提出先を複数指定しても**1度に承認できるスタッフは必ず1名**であることに注意してください。
今回の例では提出先を3名指定していますが最初の時点でA部長のみ提出先として承認棄却の権限が与えられます。A部長が承認するとA部長は共有先に自動で切り替わり、代わりに2番目の提出先（橋本主任）が提出先に自動で切り替わります。
以降このリレーが最終承認権者（提出先の最後の名前のスタッフ）まで継続します。

|-|A部長承認前|A部長承認後|
|---|---|---|
|A部長の権限|**提出先**（承認権限あり）|共有先（承認権限なし)|
|橋本主任の権限|閲覧権限無し|**提出先**（承認権限あり)|
|木村常務の権限|閲覧権限無し|閲覧権限無し|

最初の承認者であるA部長の画面を例に見てみます。A部長は提出先に指定されているため承認できます。1度A部長が承認するとその日報に対する権限が2番目の提出先である橋本主任に移り、A部長は承認・棄却ができなくなります。
またこのタイミングで日報の状態が「進行」に変化します。

{{<imgproc relay2.png   "最初の承認者が承認を押したところ。承認権限が二人目に譲渡され自身は共有先となる。そのため承認後の取り消し操作はできません" />}}

### グループのモードが共有の場合は承認リレーが少し乱れる可能性があります

もし[グループの基本設定](/org/groupsetting/make/)で日報の共有が「共有する」に設定されていると全ての日報を全員が読める状態のため、まだ承認リレー待ちである橋本主任や木村常務も**共有先**としてその日報を先読みできてしまいますので注意してください。
扱いとしては共有先になるため既読しかできませんが、承認前に上席に読まれてしまうのがまずい場合はグループのモードを「通常」にして運用することを推奨します。


{{<alice pos="right" icon="default">}}
全員が読める共有モードと承認リレーはちょっと相性が悪いんだよ
{{</alice>}}