+++
url = "/tips/analytics/"
description = "現場の日報を簡単に集計。エクセルでの手動集計を減らし、アプリから直接グラフ作成やKPI目標設定が可能。転記ミスの心配なく、効率的にデータを活用できます。"
title = "日報集計の2つのやり方・Excel集計とアプリ集計について"
toc = true
images = ['make-receipt_tablet.webp']
# tags = ["集計"]
date = "2023-06-15"
# aliases = []
[sitemap]
  priority = 0.9
+++

日報を電子化することによる恩恵は様々ありますが、**集計・分析はその最たる利点**といっても過言では有りません。

左手親指にゆびサックをはめて伝票をめくっていますか？
報告書を見てExcelに手動で入力していますか？
その作業をごっそり省略できるお手伝いができます。

## 日報の集計とは？何ができるのですか？{#report_summary}

日報はその日の報告書です。報告の文章は集計しようが有りませんが、報告書の中には「作業時間」「作業人数」「投入資材量」といった数値で表現されるデータがあります。
これらの数値データや単語のデータを簡単に集計できます。日報というよりは、伝票と表現したほうがイメージし易いかもしれませんね。

{{<icatch filename="kouji" msg="集計対象となる日報の例。文字は集計できないが数値や単語は集計できます"  alice="here">}}

日報を集計するということはこれら伝票の束をゆびサックを使ってめくり、電卓やそろばんを叩くことです。そろばんを学んでいた方は伝票計算という種目をイメージするかもしれません。

今の時代はそろばんではなく、計算にはエクセルを使うことが多いでしょう。では１枚１枚の伝票をどのようにエクセルにまとめるのか？これが大きな課題の１つです。
エクセルに日報のデータを書き写す（転記する）作業は**手間がかかる上に入力ミス、入力漏れといったリスク**が常に付きまといます。
他にも多くの機能がありますが、まず書き写す作業の削減についてご紹介します

### 数百枚の日報を1枚のエクセルシートに一瞬でまとめることが可能です。集計の準備に最適{#bulk_excel}

先ほど上で表示した工事日報は１枚１枚が独立した報告書ですがテンプレートが同じであれば、エクセルの行列で表現することができます。つまり**１枚のエクセルにまとめることが可能**であり、現場から報告された書類がそのまま集計のデータとして活用可能です。
NipoPlusでレポートをCSVに変換し、Excelで開くと次のように表示されます。

{{< excelTable >}}
承認者1, 承認者1詳細, 進捗報告, 【人】稼働人員, 【時間】稼働時間, 【kg】投入資材, 現場写真１, 現場写真２, レポートコメント
ueda 管理者, 未処理, これはサンプルです。, 4, 6, 10, CSV出力不可, CSV出力不可, コメントはありません
ueda 管理者, 未処理, サンプルです, 7, 2, 7, CSV出力不可, CSV出力不可, コメントはありません
ueda 管理者, 未処理, , 10, 8, 32, CSV出力不可, CSV出力不可, コメントはありません
ueda 管理者, 未処理, , 1, 3, 0, CSV出力不可, CSV出力不可, コメントはありません
ueda 管理者, 未処理, , 6, 7, 30, CSV出力不可, CSV出力不可, コメントはありません
{{< /excelTable >}}

今回はサンプルのためレポート件数は6件と少なめですが、たった6件の日報でも１枚のエクセルに手動でまとめるのは手間が掛かります。それをほんの数クリックで作ることができました。

C列の「進捗報告」は文字なので集計には使えませんが、D列〜F列のデータはすぐにでも集計や並べ替えとして使えそうですね。SUM関数を使えば簡単に合計を算出可能です。

このように日報の集計に必要な元データを提供するのもNipoPlusの大きなポイントの１つです。
Excelを使った様々な集計テクニックについてはExcel活用術としていくつか記事を書いていますのでよろしければ参照してください。

{{< link-card title="エクセルを使った日報集計テクニック" href="/excel/" >}}

### 集計の元データをより使いやすい形で出力可能です。用途に応じてCSV出力オプションを設定{#csv_options}

気づいていましたか？先ほどのエクセルでは、日報の提出日が有りませんでした。
また、日報に対するコメントも出力していますが集計時にコメントは不要です。
集計時に元の日報を見る必要があるかもしれませんので、元データへ直接アクセスできるURLも出力したほうが確認時に便利です。

このように、一口にCSV出力と言っても用途や目的に応じて必要な形式が変わってきます。
元データを必要な形に近づけることで、その後の集計作業をぐっと楽にできます。次の表は形式を変えて出力した例です。

{{< excelTable >}}
提出日, 承認者1, 承認者1詳細, 進捗報告, 【人】稼働人員, 【時間】稼働時間, 【kg】投入資材, 現場写真１, 現場写真２, URL
2024/05/01 09:28, ueda 管理者, 未処理, これはサンプルです。, 4, 6, 10, CSV出力不可, CSV出力不可, https://nipo-plus.web.app/#/room/BLyx3SG72rId24BnKcGC/JMl7CljRG0xwjqG4RjF5/indigo/reportBox/inbox/detail/BSDHA1WMz8xzzDDfMHeb
2024/05/02 09:28, ueda 管理者, 未処理, サンプルです, 7, 2, 7, CSV出力不可, CSV出力不可, https://nipo-plus.web.app/#/room/BLyx3SG72rId24BnKcGC/JMl7CljRG0xwjqG4RjF5/indigo/reportBox/inbox/detail/LdjSfN5Jg3HaRKlTFZzc
2024/05/03 09:28, ueda 管理者, 未処理, , 10, 8, 32, CSV出力不可, CSV出力不可, https://nipo-plus.web.app/#/room/BLyx3SG72rId24BnKcGC/JMl7CljRG0xwjqG4RjF5/indigo/reportBox/inbox/detail/GElWZRIpTZTxXjuhNuw4
2024/05/06 09:28, ueda 管理者, 未処理, , 1, 3, 0, CSV出力不可, CSV出力不可, https://nipo-plus.web.app/#/room/BLyx3SG72rId24BnKcGC/JMl7CljRG0xwjqG4RjF5/indigo/reportBox/inbox/detail/Fw0wEYTatjNK1C7T0fRK
2024/05/07 09:28, ueda 管理者, 未処理, , 6, 7, 30, CSV出力不可, CSV出力不可, https://nipo-plus.web.app/#/room/BLyx3SG72rId24BnKcGC/JMl7CljRG0xwjqG4RjF5/indigo/reportBox/inbox/detail/KAuV5MZ5WLC5WOnSVogD
{{< /excelTable >}}

提出日をCSV煮含めたことで並べ替えをしても戻せるようになりました。また、URLも併せて出力したことで、データに不審な点があったときでもURLをクリックして直ぐに元の日報を確認できるため、検証がしやすくなります。

この他にも様々なCSV出力オプションを用意しています

{{< link-card title="CSV出力オプション" href="/docs/manual/analytics/csvoption/" >}}

### 複数のCSVファイルを1つに統合する「CSVSC」のご紹介{#csvsc}

CSVはそのままエクセルで開くことができ、集計や並べ替えなど便利に利用できますが、複数のCSVを1つのエクセルシートにまとめる機能はありません。
ということでNipo公式のCSV結合システムを無償で公開しております。詳しくはCSVSCの紹介に譲りますが、一言で言うと
**複数のCSVファイルをドラッグ操作で1個のCSVに変換するWebシステム**です。

{{< link-card title="CSVSCについて詳しく" href="/tips/csvsc/" >}}

### CSVファイルが文字化けする場合の対策{#text_shaking}

もしダウンロードしたCSVが文字化けする場合は文字コードが正しく解釈されていないためです。古いExcelでよく発生します。解決法については「文字化けについて」の記事をご覧ください

{{< link-card title="文字化けについて詳しく" href="/tech/mojibake/" >}}

## エクセルを使わない簡単手軽な日報集計も可能{#easy_summary}

ここまではたくさんの日報を１枚のシートにまとめて集計の元データとして使用する前提で解説してきました。Excelの操作に慣れている方であれば、データさえ整っていれば様々な集計分析ができます。
NipoPlus自体にも集計やグラフ作成📊機能が備わっています。Excelを使った日報集計には遠く及びませんが**最大の利点はその手軽さ**です。日報を表示すると自動で過去の日報もロードし、一覧表を作成できます。また一覧表からグラフを生成することも可能です。

{{<figure src="charts.webp"  alt="工事日報を１件表示すると過去の工事日報に遡って一覧表を自動で生成し、グラフもリアルタイムで反映されます" caption="工事日報を１件表示すると過去の工事日報に遡って一覧表を自動で生成し、グラフもリアルタイムで反映されます" >}}

このデータは過去データ推移を表しています。集計とは少し意味が異なりますね。単純に合計を表示したい際は推移ではなく「累積」に切り替えることで合計を表示できます。

{{< link-card title="推移について" href="/docs/manual/analytics/transition/" >}}

またこの集計は「直近30件」という範囲で集計を行います。実務上は直近X件ではなく、「今月」や「先月」といった月単位で集計することが多いことでしょう。
個々では詳しくは触れませんが、集計期間を指定することで月単位や週単位による集計ももちろん可能です。

## 建設業などで便利に使える現場単位の集計テクニック{#construction_tips}

少し個別具体的な例をみてみましょう。先程の工事日報を単純に合計するのではなく、もっと実用的に多角的に集計したい場合があります。

- レポートを書いたスタッフごとに集計したい
- 工事現場単位で集計したい

工事現場単位で集計したい場合、その**日報がどの現場の報告であるかを識別するための情報**が必要になります。
NipoPlusでは案件管理機能があるので今回はこの方法を紹介します。
案件管理は複数の日報を一定のルールで分ける機能です。機能としての名称は「案件」ですが、工事現場と読み替えて差し支え有りません。詳しくは案件管理を御覧ください。

さて、日報を書く際にその日報がどの案件のものかを指定することで、工事現場単位による振り分けが可能になります。

{{<icatch filename="anken" msg="案件毎の集計も簡単です"  alice="here">}}

道路工事A〜Dまでの現場があったとして、各現場毎に投下した資材量や投下した人員などを現場単位で集計しましょう。
Excelを使った集計では、CSV出力オプションで「案件を出力」をONにすることで案件情報を含んだCSVがダウンロードできます。

{{< excelTable >}}
提出日, 案件, 承認者1, 承認者1詳細, 進捗報告, 【人】稼働人員, 【時間】稼働時間, 【kg】投入資材, 現場写真１, 現場写真２
2024/05/01 09:28, 不明, ueda 管理者, 未処理, これはサンプルです。, 4, 6, 10, CSV出力不可, CSV出力不可
2024/05/02 09:28, 不明, ueda 管理者, 未処理, サンプルです, 7, 2, 7, CSV出力不可, CSV出力不可
2024/05/03 09:28, 不明, ueda 管理者, 未処理, , 10, 8, 32, CSV出力不可, CSV出力不可
2024/05/06 09:28, 不明, ueda 管理者, 未処理, , 1, 3, 0, CSV出力不可, CSV出力不可
2024/05/07 09:28, 不明, ueda 管理者, 承認済み-2024.5.8, , 6, 7, 30, CSV出力不可, CSV出力不可
2024/05/08 10:54, 道路工事B, ueda 管理者, 未処理, , 7, 2, 210, CSV出力不可, CSV出力不可
2024/05/09 10:51, 道路工事C, ueda 管理者, 未処理, , 3, 4, 10, CSV出力不可, CSV出力不可
2024/05/17 10:51, 道路工事B, ueda 管理者, 未処理, , 7, 2, 210, CSV出力不可, CSV出力不可
{{< /excelTable >}}

ここで案件はB列です。「不明」は案件を登録されていない日報のため、元データを見て正しい案件をセットする必要があります。
さて、案件単位でそれぞれのデータをエクセルで集計するには少しスキルが必要になります。
このように「特定の条件に基づいて集計する」場合には、SUMIF関数が便利です。[SUMIF](/excel/sumif/)については詳しい記事を書いていますので、そちらをご覧ください。

NipoPlusの集計機能でも案件ごとに分けた集計が可能です。結構簡単です。

{{<iTablet filename="anken-calc" msg="NipoPlusの集計では専門の知識が無くても簡単に案件ごとに分けて集計が可能です" alice="book">}}

## 日報のデータからKPIを設定して目標までの到達状況を知る{#kpi}

KPIとは組織やプロジェクトの目標達成度を測定するために使われる指標です。
例えば今月の納品目標個数が800個と設定し、今月の累積納品数を見ることで目標に対して今どの程度進捗しているかを知ることが可能です。
NipoPlusはKPI専用のソフトでは有りませんが似たような機能を有しています。簡易的なKPI測定であれば日報のデータからそのままリアルタイムに進捗を知ることが可能です。

この機能は自動車部品製造メーカ様の要望で実装されました。
さて、KPIによる進捗の確認をするために１つのシンプルな日報を用意しました。

{{<icatch filename="make-receipt" msg="部品の生産個数を入力するだけの伝票のような日報。もはや伝票と表現したほうが適切？" alice="question">}}

さてこの日報（伝票）には生産個数を入力する欄がありますが、この生産個数を累積すればKPIの測定ができるわけです。話は実に単純明快です。
累積を追尾したい項目をKPIツールに設定することで、現在の進捗状況を一覧表で見ることが可能です。
製造業に特化して作られているため、全体の進捗度、日別の進捗状況、前月の在庫などを反映させることも可能です。

そして次のような条件があるとします。

- 今月800個納品する必要がある
- 月稼働20日＝1日40個作る必要がある
- 前月の繰越在庫は0である

1日40個以上生産できれば進捗は＋に上ぶれて、それ以下だと進捗に遅れが生じるという状態です。
日報から生産数をキーとして進捗管理表を作成することで次のような表が生成できます

{{<figure src="kpi-1.webp"  alt="製造数は日報から自動で吸い上げてKPI表に反映されます。日々の進捗を確認し遅れがあれば早期に対応するなどの判断が可能です" caption="製造数は日報から自動で吸い上げてKPI表に反映されます。日々の進捗を確認し遅れがあれば早期に対応するなどの判断が可能です" >}}

１日単位の進捗のほか、累積による進捗も確認が可能です。これにより遅れを早期に発見して事前に増産する等の判断材料として活用できます。
このKPI進捗の表は複数種類作成が可能です。ボタンクリックでKPIの対象を瞬時に切り替えが可能です。

進捗表はCSVにエクスポートすることも可能です。CSVに出力してエクセルで開くと次のように見えます。

{{< excelTable >}}
label, d20240501, d20240502, d20240503, d20240504, d20240505, d20240506, d20240507, d20240508, d20240509, d20240510, d20240511, d20240512, d20240513, d20240514, d20240515, d20240516, d20240517, d20240518, d20240519, d20240520, d20240521, d20240522, d20240523, d20240524, d20240525, d20240526, d20240527, d20240528, d20240529, d20240530, d20240531
生産数, 49, 10, 55, , , 100, 50, , 50, 48, , , , , , , , , , , , , , , , , , , , ,
└目標値, 40, 40, 40, , , 40, 40, 40, 40, 40, , , 40, 40, 40, 40, 40, , , 40, 40, 40, 40, 40, , , 40, 40, 40, 40, 40
└目標累積, 40, 80, 120, 120, 120, 160, 200, 240, 280, 320, 320, 320, 360, 400, 440, 480, 520, 520, 520, 560, 600, 640, 680, 720, 720, 720, 760, 800, 840, 880, 920
└実績累積, 49, 59, 114, 114, 114, 214, 264, 264, 314, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362
└進捗, 9, -21, -6, -6, -6, 54, 64, 24, 34, 42, 42, 42, 2, -38, -78, -118, -158, -158, -158, -198, -238, -278, -318, -358, -358, -358, -398, -438, -478, -518, -558
└結果, 1, 0, 1, -1, -1, 1, 1, -1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1
{{< /excelTable >}}

結果の行は内部的な数値がそのまま表示されて少し見にくいかもしれません。ここでは「１は目標を達成した」とだけ覚えてください。
このように現場のチェックシートや製造レポートを電子化することで、進捗の管理といった使い方も可能になり、データ活用がより効率よく行えることでしょう。
進捗管理表の詳しいガイドは以下のリンクをクリックしてください。

{{< link-card title="予定実績表の操作ガイド" href="/docs/manual/analytics/progress/" >}}

### 異なる種類のチェックシートを同時に集計するクロス集計{#cross}

過去データ推移表は「同じテンプレートで作成されたチェックシート」に対して有効に機能します。設備点検チェックシートを使って作られた場合、設備点検チェックシートの直近30回の推移を見れます。
設備点検シートと5Sチェックシートのように全く異なるテンプレートであれば問題にはなりませんが、例えば「A部品品質チェックシート」と「B部品品質チェックシート」が非常に似たものであり、AとBそれぞれの不良率を並べて比較したい場合があります。
前述の通り、過去データ推移表は同じテンプレートでのみ機能するため、A部品とB部品が異なるテンプレートで作られると同時比較ができません。

これに対する解決策としてクロス集計機能があります。クロスは交差という意味で、この場合は複数のテンプレートを交差させて1つの表を作る機能を指します。
クロス集計を使えば、例えばA部品の不良率とB部品の不良率を1つのデータシートにまとめることができます。並べ替えなどもできるのでどの部品の不良率が高いのかをランキングで表示したりすることが出来ます。

クロス集計は基本的に単純な足し算で行われるため、不良率のように計算で求めるデータをそのまま用いてしまうと意図しない結果が帰って来ます。
不良率のような項目を役立つ形でクロス集計に使う場合は算術列をつかって解決できます。

{{<icatch filename="cross" msg="クロス集計を使うことで複数のチェックシートテンプレートを1つの表にまとめて集計できます" alice="ok">}}

{{< link-card title="クロス集計のマニュアル" href="/docs/manual/analytics/cross/" >}}

上図はクロス集計の結果をもとに不良率の高い順に並べ替えをしている図です。
A部品のチェックシートとB部品のチェックシート、お互いに異なるチェックシートを1つの表にまとめて比較や並べ替えができます。

## 総括{#summary}

このページでは**日報の集計**にフォーカスを当てていくつかの機能を駆け足で紹介させていただきました。
単純なデータの集計や転記は人よりも機械のほうがはるかに得意な領域です。
もし日報の集計に悩んでいるのであれば、まず日報を電子化することを検討してみてください。電子化することで日報がそのまま集計の元データとして活用でき、転記の二度手間を排除できます。

Excelの腕を磨くことで様々な角度から日報の集計や分析ができるようになります。ぜひエクセル活用術も見てください。
もしExcelを使うほどでもない簡単な集計で十分であれば、NipoPlusの集計はとても手軽で便利です。ぜひ活用いただければ幸いです。
