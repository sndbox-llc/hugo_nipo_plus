+++
description = "蓄積した日報のデータを簡単に集計＆グラフ化できます。より細かい分析がしたい場合は集計データをCSVに出力することでエクセルなどの表計算ソフトを使い分析が可能です"
menuTitle = "日報の集計"
title = "日報をエクセルシートで集計しよう！提出漏れもかんたんチェック"
toc = true
weight = 109_001_011
isNipo = true
tags = ["旧バージョン"]
contributors = [ ]
aliases = ['/old/manual/analytics/']

+++

{{<button "/docs/manual/analytics/_about/" "この機能は後続のNipoPlusでもサポートされています">}}

## たくさんの日報やチェックシートを1枚のエクセルシートで集計する

例えば10名から毎日、日報が提出されると**1か月で200通**を超えてしまいます。報告がルーチン化すると、「読み流す」だけのたんなる流れ作業になっていませんか？  
日報やチェックシートは、現場の生きた声です。ぜひとも有効に活用したいものです。  
日報の中でも、集計が可能な項目があります。例えば次のような日報を想定してみましょう。

{{<imgproc report-sample.png "集計対象となる日報の例。文字は集計できないが数値は集計できる" />}}

テキスト入力や数値入力などが混在した日報です。赤い文字で書かれた項目はすべてNipoの集計機能を使って**簡単に集計**できます。

{{<alice pos="left" icon="default">}}
チェックボックスはNipoの集計には対応していませんが、CSV出力したあと、エクセル上から簡単に集計できますよ
{{</alice>}}

## Nipoの集計機能を使って日報を手軽に集計してみましょう

集計ならそろばん10段のNipoにお任せ下さい。「願いましては〜」おっと、冗談です。  
でもフラッシュ暗算より高速で正確な集計ができます。
集計するには、集計タブをクリックし、集計の条件を入力します。出状況をひと目で把握できます

{{<imgproc totaling-start.png "日報を集計する設定画面" />}}

<dl>
  <dt>集計テンプレート</dt>
  <dd>複数の日報テンプレートがある場合はここから集計するテンプレートを1つだけ選んでください。同時に異なるテンプレートを集計することはできません</dd>
  <dt>削除済みテンプレートを含む</dt>
  <dd>集計テンプレートの一覧には削除済みテンプレートは含まれません。削除したテンプレートで集計したい場合はチェックを入れてください</dd>
  <dt>集計の対象</dt>
  <dd>受信日報・送信日報から選びます。送信日報とはつまり自分の書いた日報の集計となり、自分の成績を集計すると同意義です</dd>
  <dt>集計期間</dt>
  <dd>日報を集計する期間を選択します。無料プランの場合、集計期間を変更することはできません</dd>
  <dt>集計開始</dt>
  <dd>指定した条件で日報の集計が行われます</dd>
  <dt>集計の対象日報状態</dt>
  <dd>すべて・承認済み・棄却済み・審査前から選んで集計できます。初期値は「すべて」です</dd>
</dl>

さて、これで集計が完了しました。集計の結果は画面が縦にながいため、いくつかのセッションに分けて詳しくみていきます

### 集計結果をCSVでダウンロードする

集計した日報のデータをそのままCSVにダウンロードすることができます。CSVの出力は集計対象外となる[本文](/old/parts/textarea/)などの文字データも出力されます。

{{<imgproc csv-export-option.png "集計した日報をCSVにダウンロードする" />}}

<dl>
  <dt>日報のコメントも含めてCSV出力する</dt>
  <dd>日報にコメントがある場合、そのコメントをCSVに含めて出力します</dd>
  <dt>選択肢(複数回答)の列を展開して出力する</dt>
  <dd>
    選択肢ごとに１列を消費して出力したい場合にチェックを入れてください。
  </dd>
  <dt>選択肢(単回答)の列を展開して出力する</dt>
  <dd>
    複数回答とほぼ同じです。
  </dd>
  <dt>レートの列を展開して出力する</dt>
  <dd>
    レートの数ごとに1列を消費して出力したい場合にチェックを入れてください。
  </dd>
  <dt>チェックボックスの列を展開して出力する</dt>
  <dd>
    チェックボックスのONとOFFをそれぞれ別の列に展開して出力したい場合にチェックを入れてください。
  </dd>
  <dt>範囲の列を展開して出力する</dt>
  <dd>
    範囲入力のデータを最小値と最大値の列に分けてCSV出力したい場合にチェックを入れてください。
  </dd>
</dl>

### 集計四太郎で項目ごとのランキングを見る

集計四太郎では、[数値パーツ](/old/parts/math/)に限りますが、各項目毎にランキングを表示します。手軽にランキングを表示したいときにご利用ください。

{{<imgproc matrix.png "集計四太郎による集計結果" />}}

### 提出簿と個別ダウンロード

{{<imgproc sum5.png "集計データをもとに生成される提出簿" />}}

集計に設定した条件をもとに提出簿が自動で作成されます。提出漏れの確認に使えるほか、スタッフ名や日付がボタンになっており、これらのボタンをクリックすることで該当の日報だけを個別にダウンロードできます。  
左側にあるチェックボックスにチェックを入れて**チェックしたスタッフの日報をDL**ボタンを押すと、チェックされたスタッフの日報だけを含んだCSVファイルがダウンロードされます。

### スタッフ１名のデータ推移詳細分析

選択した期間における１名のスタッフのデータを細かく表で確認できます。

{{<imgproc line-chart.png "1名のスタッフを対象に、データの推移をグラフ＆テーブルで詳細に表示します" />}}

{{<alice pos="left" icon="default">}}
X軸の日付がよく見るとボタンになっています。クリックすると集計対象となった日報をその場で確認できます
{{</alice>}}

詳細推移分析では、数値だけでなく文字系の項目（例えば[選択肢](/old/parts/select/)などが該当します）も集計として表示されます。
テーブルはX軸に日付、Y軸に日報の項目がセットされます。この詳細データはそのままCSVに出力することもできます。このとき、文字系の項目は行が展開されてダウンロードされます。

{{<imgproc csv-excel.png "詳細データをCSV出力し、エクセルで開いた画面" />}}

### 集計期間のスタッフごとの累計を分析

指定した集計期間の合計値を一覧で表示できます。

{{<imgproc bar-chart.png "集計期間の合計をスタッフごとに棒グラフで表示" />}}

こちらは前述の推移とは違い、**期間の合計**です。X軸にスタッフ名、Y軸に各項目が表示されます。X軸のスタッフ名はボタンになっており、クリックすると**集計前の日報を個別に確認**できます。
累計のデータはそのままCSVにダウンロードすることもできます。

{{<imgproc csv-excel2.png "累計データをそのままCSVに出力し、エクセルで開いた画面" />}}

## 複数のCSVファイルを1つに統合する「CSVSC」のご紹介

{{<imgproc multi-csv-file.png "複数のCSVファイル" />}}

CSVはそのままエクセルで開くことができ、集計や並べ替えなど便利に利用できますが、複数のCSVを1つのエクセルシートにまとめる機能はありません。  
ということでNipo公式のCSV結合システムを無償で公開しております。詳しくはCSVSCの紹介に譲りますが、一言で言うと
**複数のCSVファイルをドラッグ操作で1個のCSVに変換するWebシステム**です。

## カレンダーから集計する機能

このページでは集計ページを使って日報を集計する方法について解説しましたが、カレンダーから簡易的な集計をすることもできます。
月間カレンダー上で日報のデータを集計する例

{{<imgproc calendar-totaling.png "月間カレンダー上に集計データを表示する" />}}

スタッフ毎カレンダーで集計を表示した例

{{<imgproc agenda-totaling.png "スタッフ毎カレンダー上に集計データを表示する" />}}

カレンダーの使い方については、[カレンダーのページ](/old/manual/calendar/)をご覧ください

## CSVファイルが文字化けする場合の対策

Nipoのデータはすべて**UTF-8**で保存されますが、古いエクセル（Excel 2007やそれ以前のバージョン)でCSVファイルを開くと、文字コードをSHIFT-JISとして認識して開いてしまうことがあります。
文字コードが異なると当然ですが**文字化け**が発生し、データを読むことができません。この場合はCSVファイルを開くとき、文字コードをUtf-8と指定して開くことで回避してください。

{{<imgproc old-excel.png "Excel2007の画面" />}}
{{<imgproc csv-import.png "Excel2007の画面" />}}
{{<imgproc comma-separate.png "Excel2007の画面" />}}
