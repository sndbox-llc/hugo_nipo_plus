+++
title = "たくさんの日報を1枚のCSVファイルに一括出力する"
menuTitle = "CSV出力（一括）"
description = ""
# tags = ["CSVエクスポート", "集計機能"]
weight = 30
+++


日々蓄積していく個別の日報やチェックシートを、月単位や週単位、直近10日間など任意の期間を指定してその期間のデータを一括でCSVに出力することができます。
出力された日報のCSVファイルは単純なテキストファイルのため、テキストエディタやExcel・Google Sheetなどの表計算ソフトで開くことができます。
大切な日報データのバックアップや、データ集計・分析などにお役立てください。
一括ダウンロードではなく、1つの日報だけCSV出力したい時は[CSV出力（単体）](/report/read/csv/)をご覧ください

CSVの一括ダウンロード機能はAndroid / iOSアプリ版では利用できません。

{{<alice pos="right" icon="phone">}}
スマホからCSVを出力したいときはPWA版としてインストールしてね。[Android](/system/android/)はこちら、[iOS](/system/ios/)はこちらを参照してください
{{</alice>}}

## 日報をまとめてCSVに変換してダウンロードする手順

一括ダウンロードは日報集計機能から行います。もし左メニューに「集計」が表示されていない場合は[グループの基本設定](/org/groupsetting/make/)を開き、「メニューに集計を表示」のチェックをONにしてください。

1. 日報の集計をクリック（表示されない場合は[グループの基本設定](/org/groupsetting/make/)を確認）
1. 出力したい期間を選びます（初期値は今月）
1. CSV出力ボタンをクリックします

{{<imgproc csvexport.png "複数のチェックシートや日報データを1枚のCSVファイルに纏めてダウンロードします" />}}

これで指定した期間に含まれる全ての日報やチェックシートが一括でCSV形式でダウンロードされます。
CSVファイルは日報やチェックシートの**テンプレート単位でファイルに分けて出力**されます。例えば「日報」と「報告書」の2種類があったとします。
この場合は

- 日報.csv
- 報告書.csv

の2つが含まれたZipファイルとして出力されます。指定期間内に1度も使用されなかったテンプレートは自動で除外されます。
また、無効化したテンプレートであっても集計期間内に使用された実績があればCSVに出力されます。
集計期間内に使用されたテンプレートが1種類しか無い場合はZipファイルではなく、ただの1つのCSVファイルとして出力されます。
処理上はファイルのダウンロードとなるため、ブラウザの設定通りの挙動を振る舞います。
ブラウザの設定によっては自動でdownloadフォルダに入る場合もありますし、保存先を自分で指定する場合もあります。
ブラウザの設定によって異なるためご利用の端末設定をご確認ください。

{{<alice pos="right" icon="ok">}}
ダウンロードしたCSVファイルはエクセルやgoogle splead、テキストエディタ等で開けるよ
{{</alice>}}

## CSVを解凍すると文字化けする？

WindowsでZipファイルを解凍する際、使用する解凍ソフトによっては文字化けすることがあります。これは解凍ソフトが文字コードを正しく理解していないために起こります。
Windows標準の解凍ソフトであれば文字化けは発生しません。文字化けが発生する際は使用する解凍ソフトを変更してください。
詳しくは[ダウンロードしたファイルが文字化けする原因と解決策](/tech/mojibake/)を御覧ください。

{{<alice pos="right" icon="ok">}}
なお文字化けはファイル名のみで、ファイルの中身自体は問題なく表示可能です。
{{</alice>}}

## CSVの出力形式を変更すると集計やデータ加工の手間が軽減できます

NipoPlusのCSVの出力はいくつかのオプションを選択してCSVの形式を変更することができます。
出力オプションを変更するには「CSV出力」ボタンの右隣にある下向きの三角矢印ボタンを押して設定できます。設定は自動で保存され、次回以降も同様の設定でCSV出力が行われます。

{{<imgproc csvsetting.png "CSVの出力形式を変更できます。集計用やバックアップ用など、用途に応じて設定を変えることでデータ加工の手間を軽減できます" />}}

CSV出力の設定に関する解説

|名称|説明|
|---|---|
|[選択肢（単回答）](/org/groupsetting/template/select/)の展開|ONにすると選択肢の回答毎に1列使用した出力が行われます。OFFの場合は1列に回答が出力されます|
|[選択肢（複数回答）](/org/groupsetting/template/select/)の展開|ONにすると選択肢（複数回答）の回答毎に1列使用します。OFFの場合は1列に回答がすべてまとめられます|
|[レート](/org/groupsetting/template/rate/)の展開|ONにするとレートの最大数の数だけ列が追加され、選択されたレート毎に○がつく形でCSV出力されます|
|[チェックボックス](/org/groupsetting/template/checkbox/)の展開|ONにすると「Yes」と「NO」の2列に展開されて出力されます|
|行列を入れかえる|通常は1行に1つの日報を表示しますが、これがONだと1列に1つの日報を表示するようになります|
|提出日を出力|ONの場合は日報の提出日時をCSVにファイルに含めます|
|提出者IDを出力|ONの場合日報・チェックシートを作成したスタッフのIDをCSVファイルに含めます|
|提出者名を出力|ONの場合日報・チェックシートを作成したスタッフ名をCSVファイルに含めます|
|[状態](/report/read/state/)を出力|、現在の状態を承認・棄却・新規・進行・修正のいずれかで出力します|
|承認者名を出力|日報・チェックシートを承認するスタッフと承認・棄却の状態をCSVファイルに出力します。承認者が複数人いる場合は人数分列が追加されて出力されます|
|文書IDを出力|日報やチェックシートには固有のIDが自動で割り当てられますがそのIDをCSV上に出力します|

文字だとうまくイメージしにくいと思いますので、実際のデータを用意しました。一番シンプルな「チェックボックスの展開」を例にしています。
{{<imgproc csv_sample.png "CSV出力したデータをエクセルで開いた例" />}}

上が列展開OFFで、下が列展開ONです。緑、黄、赤それぞれが同じデータを指し示していますが、出力のされ方が大きく違います。
特に列展開がONの場合はOFFと比べて2倍の列数になっていることがわかります

## 先月のCSVファイルと今月のCSVファイルを連結させたいとき

毎月月末にCSVファイルをダウンロードすると、先々月のCSV・先月のCSV・そして今月のCSVと月ごとに分けてCSVファイルが増えていくことになります。
日付が分かるように管理すれば月ごとに見つけやすくて便利ですが、もしこれらのCSVファイルを1つのCSVファイルに結合したい場合は[CSVSC](/blog/csvsc/)というサービスを利用してみてください。

（注意！行列の入れ替えをしているとうまく機能しません）

CSVSCは複数のCSVファイルをドラッグするだけで1つのCSVに連結するウェブアプリです。もともとNipoのために開発されたソフトです。

### CSVの用途に応じて最適なCSVの出力オプションを選ぶ

このようにチェックシートのデータをCSVに出力する際は形式がある程度操作できることがわかりました。
出力するCSVファイルはその目的に応じて適切なオプションを選ぶことが重要です。
例えばデータの保管用として出力する場合、会議資料や集計用として使用する場合によって適切な形式が異なります。
前述したチェックボックスの例を基準に考えてみましょう。例えば保管用としては列の展開をOFFにしたほうが視認性が高く、見やすい形式となっています。
一方で列を展開すると○と-に分かれるため、エクセルのCountif関数などでデータ件数を集計しやすくなるというメリットがあります。
ご利用目的に応じて最も加工しやすい設定を行うことで、データ加工の手間を削減できる可能性があります。ぜひ最適なオプションを探ってみてください。


### CSV出力が不可能な入力フォームについて

NipoPlusではテンプレートを自由にカスタマイズできるのが大きな特徴です。使用している入力フォームの中にはCSV出力に対応していないものもありますので、CSV出力を前提とした運用をお考えの場合はこれらの入力フォームを使用しないほうがより確実です。 CSVに出力できない入力フォームは以下のとおりです

- [写真入力フォーム](/org/groupsetting/template/picture/)
- [署名入力フォーム](/org/groupsetting/template/sign/)
- [ファイル入力フォーム](/org/groupsetting/template/file/)

これらのデータは「CSV出力不可」と書かれて出力されます。

### サンプルデータのダウンロード

このページで使用した実際のサンプルをダウンロードできます

{{<attachments style="orange" />}}
