+++
description = "蓄積したチェックシートデータをグラフ化・集計・CSV出力して分析できます。"
menuTitle = "集計/P管理図/データシート"
tags = []
title = "製造業チェックシートで集計や不良率ランキングを自動計算"
toc = false
weight = 10
+++

NipoPlusはもともと日報用のアプリでしたが、今ではどちらかというと製造業向けのアプリになりつつあります。
製造業者様から多くのリクエストを頂き、製造業のベース的な部分（日報、チェックシート、P管理図、不良率集計）がほぼ完成してしまったためです。

{{<alice pos="right" icon="here">}}
良品数、不良数、不良率もカレンダーを使って期間ごとに表示できて、さらにソートでランキングも出せます
{{</alice>}}

## 製造ラインごとに異なるテンプレートを作ってライン毎に不良率などを算出

話を単純にするためにまずはシンプルなチェックシートのテンプレートを作りました。以降はこのテンプレートをベースに話が進んでいきます。

{{<appscreen filename="checksheet" title="製造業向けの部品品質チェックシートサンプル" >}}

とある部品Aの品質チェックシートです。全く同じテンプレートで部品Bのチェックシートも作っていますがこれは後述します。
なおテンプレートは自由に設計できます。多様なテンプレートを紹介していますのでよろしければご参照ください。
{{<button "/blog/template/" "こんなテンプレートも？実例も交えてご紹介">}}

### 製品チェックシートの入力、集計、P管理図などのグラフ作成もできます

製造チェックシートへの入力はスマートフォンでもタブレットでも可能です。
今回の例では1枚のチェックシートに生産数と不良数を入力する[数値入力フォーム](/manual/initial-setting/template/math/)があります。
また不良率を求める入力フォームは[算術入力フォーム](/manual/initial-setting/template/calc/)が利用されています。
不良率は次の計算で求めることが可能です。

```sh
（不良数÷生産数）×100
```

仮に生産数が100で不良数が5だった場合、不良率は5%と自動で計算して表示します。それではチェックシートの項目を入力していきます。

{{<appscreen filename="auto-calc" title="チェックシートにデータを入力します。スマホやタブレットからも入力が可能です。不良率などの計算フォームがある場合は自動で値が計算されます" >}}

{{<button "/manual/write-report/" "日報を書くのマニュアルへ">}}

不良率に小数点が出る場合は端数処理の桁数を指定できます。デフォルトでは小数点以下第3位で四捨五入が行われます。
1枚1枚のチェックシートに対する不良率の計算はこのようにシンプルに行うことが出来ます。
やっていること自体はエクセルの計算とそこまで変わりはありませんが、エクセルに比べてスマホやタブレットでも入力しやすいように設計されています。

さて、部品のチェックシートも日々の業務の中で枚数がどんどん増えていくことになります。
製造業の方からのリクエストで、前回、前々回など、過去のチェックシートデータと今回のデータの比較を知りたいというご要望からNipoPlusでは業務チェックシートの過去データ推移機能をサポートしています。
同じチェックシートのテンプレートで作られたデータを時系列に並べて表示する機能を使い、過去の推移を俯瞰できます。

{{<appscreen filename="history" title="過去データ推移を使うと前回・前々回のチェックシートのデータと今回のチェックシートデータを比較しながら確認することが可能です"  >}}

{{<button "/manual/analytics/list" "過去データ推移のマニュアルへ">}}

このデータシートは左端に現在表示中のチェックシートが配置され、右に行くに連れてより古い過去のチェックシートデータが並びます。
今回の不良率と前回の不良率の比較も過去データ推移を使うことでかんたんに確認ができます。
表示件数は設定で変更できますが、最大で30件までのチェックシートデータを並べて比較出来ます。
さて、一覧表があると今度は視覚的に表示したいという要望がでてきます。
ある製造業者の方からは**P管理図**と聞きました。P管理図に限らず任意のチェックシートデータをグラフ化することが可能です。
例えば生産数と不良数の積み上げ棒グラフを作り、第2軸に不良率の折れ線グラフを設定するといったことも可能です。

{{<appscreen filename="charts" title="チェックシートのデータをもとにP管理図を作成" >}}



**P管理図**のようなグラフができました。この他にも例えば製造区分の割合や使用カラーの割合を円グラフで作成するといったことも可能です。
（製造区分はサンプルのチェックシートで設定された入力フォームです。忘れてしまった方はこの頁のトップ画像をもう一度見直してみてください）
グラフは複数種類作成することができ、ボタン1つでグラフを瞬時に切り替えることが可能です。

{{<appscreen filename="pie-chart" title="チェックシートのデータをもとに円グラフを作成" >}}

{{<button "/manual/analytics/chart" "グラフ作成マニュアルへ">}}

このようにチェックシートのデータからグラフ化したいデータを自由に設定してお好みのグラフを設計出来ます。
またデータシートはそのままCSVファイルとしてダウンロードすることもできます。CSVはエクセルなどの表計算ソフトからそのまま開くことができるので、
ダウンロードして任意のグラフや並べ替えなど多角的な分析をすることも可能です。CSVについては本ページ末尾で詳しく解説しています。

### スタッフを基準とした累積集計

時系列によるチェックシートの俯瞰とは別に、データの累積を表示することもできます。
累積ではスタッフアカウントを基準としてスタッフごとに分けたデータの集計が行われます。
集計は単純な足し算で有ることに注意する必要があります。今回の例でいうと不良率は単純に足すと意図しない値になってしまいます。
集計で不良率を求めたい場合は、集計行を作成することで対応出来ます。

{{<appscreen filename="sumtotal" title="チェックシートのデータをスタッフを基準として集計する" >}}

不良率が2行になってしまい、しかも一方は不正確な値を示すことになりますのでその点はご了承願います。
この問題は開発側も認知しており、なにか良い方法がないか思案しています。

{{<alice pos="right" icon="please">}}
もし良いアイデアがあれば問合せフォームから教えて下さい
{{</alice>}}

## 業務チェックシートの集計を期間を区切って行う

これまで紹介してきたチェックシートの集計やグラフ化は、「直近○件」といった推移によるものでした。
この機能はスタッフが提出したチェックシートを見ながら過去のデータも比較できるという手軽さの面では有益ですが、いざ集計するときは通常、1ヶ月単位や週単位など期間を絞った集計が必要になるはずです。
任意の期間を指定して過去のチェックシートデータを集計したり、グラフ化するには「集計・CSV出力」機能から行うことが出来ます。

{{<appscreen filename="analytics" title="期間を指定してチェックシートのデータを集計する" >}}

{{<button "/manual/analytics/transition" "データ集計のマニュアル">}}

集計機能ではまず右パネルのカレンダーから集計する期間を選択します。初期値は「今月」ですが、カレンダーをクリックして任意の期間へ変更出来ます。
続いて集計対象のチェックシートテンプレートを選びます。
お伝え漏れしていましたが、NipoPlusではチェックシートのテンプレートを複数種類作成することが出来ます。
これまでの例では「A部品チェックシート」のみが登場していましたが、当然B部品チェックシートがあっても良いわけです。  

集計するテンプレートを選択すると、そのテンプレートで作成されたデータのみが集計されます。
集計表やグラフの見方については過去データ推移のときと同じです。
単純に集計期間が変わっただけです。作成しているグラフなどは集計でも共通で利用可能です。

### 異なるチェックシートのテンプレートを同時に集計するクロス集計について

チェックシートのテンプレートはそれぞれ異なる入力フォームである可能性があるため、この集計では複数のテンプレートを同時に集計することは出来ません。
複数のテンプレートを1つの表にまとめるには、クロス集計機能を利用する必要があります。
クロス集計を使えば、例えばA部品の不良率とB部品の不良率を1つのデータシートにまとめることができます。並べ替えなどもできるのでどの部品の不良率が高いのかをランキングで表示したりすることが出来ます。

クロス集計は基本的に単純な足し算で行われるため、不良率のように計算で求めるデータをそのまま用いてしまうと意図しない結果が帰って来ます。
不良率のような項目を役立つ形でクロス集計に使う場合は算術列をつかって解決できます。

{{<appscreen filename="cross" title="クロス集計を使うことで複数のチェックシートテンプレートを1つの表にまとめて集計できます" >}}

{{<button "/manual/analytics/cross/" "クロス集計のマニュアル">}}

上図はクロス集計の結果をもとに不良率の高い順に並べ替えをしている図です。
A部品のチェックシートとB部品のチェックシート、お互いに異なるチェックシートを1つの表にまとめて比較や並べ替えができます。

## 業務チェックシートのデータをエクセルで集計する

ここまではNipoPlusのもっている集計やグラフ機能を基準にご紹介してきました。
チェックシートのデータをCSVに出力することで、ExcelやGoogle SpreadSheetなどの表計算ソフトで自由に集計や並べ替え、グラフの作成をすることも可能です。
このページで実際に作った積み上げ棒グラフ＆折れ線グラフと円グラフを、エクセル上で描画することも可能です。

![チェックシートのデータをエクセルでグラフ化する](excel-chart.png)

{{<alice pos="right" icon="ok">}}
見覚えのあるグラフですって？データが同じですからグラフも同じになります
{{</alice>}}

<div style="background:lightcyan;padding:30px">

補足：日付形式を短くしたいときは、日付の範囲を選び表示形式から「短い日付形式」を選ぶことで設定できます

{{<imgproc format-excel.png "エクセルで日付形式の表示を短くする" />}}

</div>

CSV出力したデータは、集計が不可能な本文やコメントといったデータも出力されますのでデータのバックアップとしても最適です。
もしNipoPlusの利用を辞める時も、データをバックアップしておけば過去のデータを失う心配はありませんし、他のサービスでこのCSVデータをインポートして利用できる可能性もあります。


## でもお高いんでしょう？いいえ、1名180円で最低10名からご利用可能です

NipoPlusは日報・チェックシートアプリ界で業界最安値を目指しています。お一人あたり１ヶ月180円という料金は同業他社に比べて半額以下の低水準です。
余分なコスト（広告費やら仲介手数料やら）を極力抑えています。
最低利用人数の制限はありますが、それでも最も安くて月額1800円からご利用可能です。詳しくは[料金について](/price/)を御覧ください。
